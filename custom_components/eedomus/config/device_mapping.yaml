# Eedomus Device Mapping Configuration
# Version: 1.3
# 
# This file defines how eedomus devices are mapped to Home Assistant entities.
# Users can customize this mapping through the options flow interface.
#
# Priority order:
# 1. User custom mappings (custom_mapping.yaml)
# 2. Advanced rules (RGBW detection, parent-child relationships)
# 3. Usage ID mappings
# 4. Name pattern matching
# 5. Default mapping

# üå°Ô∏è CLIMATE ENTITY GUIDE
# Eedomus supports several types of climate devices for heating control:
#
# 1. Temperature Setpoints (usage_id=15):
#    - Direct temperature control for heating zones
#    - Supports 7.0¬∞C to 30.0¬∞C range with 0.5¬∞C precision
#    - Best for: Room thermostats, zone heating control
#
# 2. Fil Pilote Standard (usage_id=19):
#    - French electric heating protocol
#    - Modes: Confort (~19¬∞C), Eco (~17¬∞C), Hors Gel (~8.5¬∞C), Arret
#    - Best for: Electric radiators, baseboard heaters
#
# 3. Fil Pilote Advanced (usage_id=20):
#    - Enhanced Fil Pilote with extended features
#    - May support additional protocols or precision
#    - Best for: Newer Fil Pilote controllers
#
# 4. Multi-Zone Fil Pilote (usage_id=38):
#    - Zone heating and energy management
#    - Advanced scheduling and monitoring
#    - Best for: Whole-home heating systems
#
# Climate entities automatically:
# - Detect acceptable temperature ranges from device configuration
# - Integrate with child temperature sensors (usage_id=7)
# - Support HVAC modes: HEAT and OFF
# - Provide current temperature reading when available
#
# Troubleshooting climate devices:
# 1. Verify device has correct usage_id in eedomus
# 2. Check acceptable values in eedomus device configuration
# 3. Ensure child temperature sensors are properly mapped
# 4. Confirm Fil Pilote wiring matches eedomus configuration

version: 1.3

# Advanced mapping rules for complex device detection
advanced_rules:
  - name: "rgbw_lamp_by_children"
    priority: 1
    conditions:
      - usage_id: "1"
      - min_children: 4
    mapping:
      ha_entity: "light"
      ha_subtype: "rgbw"
      justification: "RGBW lamp detected by having at least 4 children with usage_id=1"
      is_dynamic: true

  - name: "rgbw_child_brightness"
    priority: 1
    conditions:
      - usage_id: "1"
      - has_parent: true
      - parent_usage_id: "1"
      - parent_has_min_children: 4
    mapping:
      ha_entity: "light"
      ha_subtype: "brightness"
      justification: "RGBW child brightness channel (child of RGBW lamp)"
      is_dynamic: true

  - name: "Smoke Detector"
    priority: 2
    conditions:
      - usage_id: "27"
    mapping:
      ha_entity: "binary_sensor"
      ha_subtype: "smoke"
      justification: "Smoke detector device"
      is_dynamic: true

  - name: "Motion Sensor"
    priority: 2
    conditions:
      - usage_id: "37"
    mapping:
      ha_entity: "binary_sensor"
      ha_subtype: "motion"
      justification: "Motion sensor device"
      is_dynamic: true

# Usage ID mappings
usage_id_mappings:
  "0":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Unknown device type - default to switch"
    is_dynamic: true
  
  "1":
    ha_entity: "light"
    ha_subtype: "dimmable"
    justification: "Dimmable light device"
    is_dynamic: true
    
  "2":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Generic switch - usage_id=2 for basic on/off devices"
    is_dynamic: true

  "4":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Generic switch - usage_id=4 for electrical appliances"
    is_dynamic: true

  "7":
    ha_entity: "sensor"
    ha_subtype: "temperature"
    justification: "Temperature sensor - usage_id=7 for temperature monitoring"
    is_dynamic: false

  "14":
    ha_entity: "select"
    ha_subtype: "shutter_group"
    justification: "Shutter group control - usage_id=14 for virtual shutter grouping"
    is_dynamic: false
  
  "15":
    ha_entity: "climate"
    ha_subtype: "temperature_setpoint"
    justification: "Virtual thermostat for heating setpoint control"
    documentation: "Direct temperature setting for eedomus heating zones. Supports temperature range 7.0¬∞C-30.0¬∞C with 0.5¬∞C precision. Automatically detects acceptable temperature values from device configuration."
    example_devices: ["Consigne Salon", "Temperature Setpoint Chambre", "Chauffage Cuisine"]
    features:
      - Direct temperature control via eedomus API
      - Automatic min/max temperature detection
      - Child sensor integration for current temperature reading
      - Fil Pilote protocol compatibility
      - HVAC modes: HEAT and OFF
    compatibility_notes: "Works with eedomus virtual thermostats and heating zone controllers. Requires usage_id=15 for direct temperature setting."
    troubleshooting: "If temperature changes don't apply, check device's acceptable values in eedomus configuration."
    is_dynamic: false
  
  "18":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Current day information from eedomus"
    is_dynamic: false
  
  "19":
    ha_entity: "climate"
    ha_subtype: "fil_pilote"
    justification: "Fil pilote heating system control - usage_id=19"
    documentation: "French standard Fil Pilote heating protocol. Supports multiple operating modes through temperature mapping: Confort (~19-21¬∞C), Eco (~16-18¬∞C), Hors Gel (~7-10¬∞C), and Arret (off). Automatically maps eedomus values to Home Assistant temperature setpoints."
    example_devices: ["Fil Pilote Salon", "Chauffage Chambre Parent", "Radiateur Salle de Bain"]
    features:
      - Fil Pilote protocol implementation
      - Automatic mode-to-temperature mapping
      - Child temperature sensor integration
      - Energy-efficient mode switching
      - Compatibility with French heating standards
    fil_pilote_modes:
      Confort: "19.0¬∞C"
      Eco: "17.0¬∞C"
      Hors Gel: "8.5¬∞C"
      Arret: "off"
    compatibility_notes: "Requires eedomus Fil Pilote controller. Works with most French electric heating systems. Verify wire connections match Fil Pilote standard."
    troubleshooting: "If modes don't change, check Fil Pilote wire connections and eedomus device configuration. Ensure device accepts the mapped temperature values."
    advanced_configuration: "Temperature mappings can be customized in advanced YAML configuration if standard values don't match your specific Fil Pilote controller."
    is_dynamic: false
  
  "20":
    ha_entity: "climate"
    ha_subtype: "fil_pilote"
    justification: "Fil pilote heating system control - usage_id=20"
    documentation: "Alternative Fil Pilote implementation for specific controller models. Similar to usage_id=19 but may use different temperature mappings or communication protocols. Check your specific device documentation for exact behavior."
    example_devices: ["Fil Pilote Avanc√©", "Chauffage Intelligent", "Thermostat Connect√©"]
    features:
      - Alternative Fil Pilote protocol variant
      - Extended temperature range support
      - Enhanced precision control
      - Compatibility with newer controller models
      - Automatic protocol detection
    compatibility_notes: "Usage_id=20 typically found in newer eedomus Fil Pilote controllers. May support additional features beyond standard Fil Pilote. Verify controller specifications."
    troubleshooting: "If device doesn't respond, check for firmware updates in eedomus interface. Some usage_id=20 devices require specific configuration profiles."
    configuration_tips: "For optimal performance, pair with eedomus temperature sensors (usage_id=7) for accurate room temperature feedback."
    is_dynamic: false
  
  "22":
    ha_entity: "sensor"
    ha_subtype: "moisture"
    justification: "Moisture sensor - Sonoff SNZB-02D/SNZB-02P via Zigate"
    is_dynamic: false
  
  "23":
    ha_entity: "sensor"
    ha_subtype: "cpu"
    justification: "CPU usage monitor - eedomus internal system monitoring"
    is_dynamic: false
  
  "24":
    ha_entity: "sensor"
    ha_subtype: "illuminance"
    justification: "Luminosity sensor - usage_id=24 for light level monitoring"
    is_dynamic: false

  "26":
    ha_entity: "sensor"
    ha_subtype: "energy"
    justification: "Energy consumption meter - virtual eedomus consumption counter"
    is_dynamic: false
  
  "27":
    ha_entity: "binary_sensor"
    ha_subtype: "smoke"
    justification: "Smoke detector - usage_id=27 for fire/smoke detection"
    is_dynamic: true
  
  "28":
    ha_entity: "sensor"
    ha_subtype: "power"
    justification: "Power consumption sensor - usage_id=28 for real-time power monitoring"
    is_dynamic: false
  
  "29":
    ha_entity: "sensor"
    ha_subtype: "energy"
    justification: "Energy consumption sensor - usage_id=29 for cumulative energy monitoring"
    is_dynamic: false
  
  "27":
    ha_entity: "binary_sensor"
    ha_subtype: "smoke"
    justification: "Smoke detector - usage_id=27 for fire/smoke detection"
    is_dynamic: true
  
  "34":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Day phase information from eedomus"
    is_dynamic: false
  
  "35":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Miscellaneous eedomus app data (sun elevation, azimuth, etc.)"
    is_dynamic: false
  
  "36":
    ha_entity: "binary_sensor"
    ha_subtype: "moisture"
    justification: "Flood/water detector - usage_id=36 for water leakage detection"
    is_dynamic: true
  
  "37":
    ha_entity: "binary_sensor"
    ha_subtype: "motion"
    justification: "Motion detector - usage_id=37 for movement detection"
    is_dynamic: true
  
  "38":
    ha_entity: "climate"
    ha_subtype: "fil_pilote"
    justification: "Fil pilote heating control - usage_id=38"
    documentation: "Specialized Fil Pilote variant often used for zone heating or multi-room systems. May include advanced features like scheduling, energy monitoring, or integration with other smart home protocols."
    example_devices: ["Fil Pilote Zones", "Chauffage Multi-Pi√®ces", "Gestion √ânergie"]
    features:
      - Multi-zone heating control
      - Energy consumption monitoring
      - Advanced scheduling capabilities
      - Protocol extension support
      - Integration with eedomus energy management
    compatibility_notes: "Usage_id=38 devices often require additional configuration in eedomus interface. May support multiple virtual thermostats or heating zones from a single physical controller."
    advanced_features: "Some usage_id=38 controllers support energy consumption reporting, predictive algorithms, or integration with weather forecasts for optimized heating."
    troubleshooting: "For complex setups, verify zone assignments in eedomus configuration match physical wiring. Check energy monitoring calibration if readings seem incorrect."
    performance_tips: "Enable energy monitoring in eedomus settings for detailed consumption analytics and cost optimization."
    is_dynamic: false
  
  "42":
    ha_entity: "select"
    ha_subtype: "shutter_group"
    justification: "Shutter centralization control - eedomus virtual device"
    is_dynamic: false
  
  "43":
    ha_entity: "select"
    ha_subtype: "automation"
    justification: "Eedomus scene trigger - virtual device for automation"
    is_dynamic: false
  
  "48":
    ha_entity: "cover"
    ha_subtype: "shutter"
    justification: "Shutter/blind control - usage_id=48 for window coverings"
    is_dynamic: true
  
  "50":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Camera privacy control - usage_id=50 for camera intimacy"
    is_dynamic: true

  "52":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Sonoff switch/remote control - usage_id=52"
    is_dynamic: true
  
  "82":
    ha_entity: "select"
    ha_subtype: "color_preset"
    justification: "RGBW color preset selection - usage_id=82"
    is_dynamic: false
  
  "114":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Network detection status - eedomus app data"
    is_dynamic: false
  
  "52":
    ha_entity: "switch"
    ha_subtype: ""
    justification: "Sonoff switch/remote control - usage_id=52"
    is_dynamic: true
  
  "82":
    ha_entity: "select"
    ha_subtype: "color_preset"
    justification: "RGBW color preset selection - usage_id=82"
    is_dynamic: false

  "48":
    ha_entity: "cover"
    ha_subtype: "shutter"
    justification: "Shutter/blind control - usage_id=48 for window coverings"
    is_dynamic: true

  "26":
    ha_entity: "sensor"
    ha_subtype: "energy"
    justification: "Energy consumption meter - virtual eedomus consumption counter"
    is_dynamic: false
  
  "84":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Calendar day type information from eedomus"
    is_dynamic: false
  
  "114":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Network detection status - eedomus app data"
    is_dynamic: false
  
  "127":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Miscellaneous text data - usage_id=127"
    is_dynamic: false
  
  "999":
    ha_entity: "select"
    ha_subtype: "virtual"
    justification: "Virtual device - eedomus scene triggers and automation"
    is_dynamic: false
  
  "100":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus system information - usage_id=100"
    is_dynamic: false
  
  "101":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus system status - usage_id=101"
    is_dynamic: false
  
  "102":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=102"
    is_dynamic: false
  
  "103":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=103"
    is_dynamic: false
  
  "104":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=104"
    is_dynamic: false
  
  "105":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=105"
    is_dynamic: false
  
  "106":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=106"
    is_dynamic: false
  
  "107":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=107"
    is_dynamic: false
  
  "108":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=108"
    is_dynamic: false
  
  "109":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=109"
    is_dynamic: false
  
  "110":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=110"
    is_dynamic: false
  
  "111":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=111"
    is_dynamic: false
  
  "112":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=112"
    is_dynamic: false
  
  "113":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=113"
    is_dynamic: false
  
  "114":
    ha_entity: "sensor"
    ha_subtype: "text"
    justification: "Eedomus app data - usage_id=114"
    is_dynamic: false

# Name pattern mappings (regex patterns)
name_patterns:

# Default mapping (fallback)
default_mapping:
  ha_entity: "sensor"
  ha_subtype: "unknown"
  justification: "Default fallback mapping for unknown devices"
  is_dynamic: false

# Entity type dynamic properties (default values)
# These define which entity types are dynamic by default
# Dynamic devices are those whose state can change unpredictably due to user actions
# They are included in opportunistic refresh mechanisms for real-time updates
# Can be overridden in specific mappings
dynamic_entity_properties:
  light: true      # Lights can be toggled manually - require frequent updates
  switch: true     # Switches can be toggled manually - require frequent updates
  binary_sensor: true  # Motion detectors, door sensors - state changes unpredictably
  sensor: false    # Temperature, humidity - change slowly and predictably
  climate: false   # Thermostat settings - change infrequently
  cover: true      # Shutters/blinds can be operated manually - require frequent updates
  select: false    # Selection menus - change infrequently
  scene: false     # Scene activations - change infrequently

# Specific device dynamic overrides
# Allow users to specify dynamic behavior for individual devices by periph_id
# Format: periph_id: is_dynamic (true/false)
specific_device_dynamic_overrides:
  # Example:
  # "123456": true
  # "789012": false